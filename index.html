<!DOCTYPE html>
<head>
    <title>NEC Input Field</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ§ª</text></svg>">
    <script>
        function calculate() {
            var mass = document.getElementById("mass").value;
            var anodeFoil = document.getElementById("anodeFoil").value;
            var cathodeFoil = document.getElementById("cathodeFoil").value;
            var ampPerGram = document.getElementById("ampPerGram").value;
            if (anodeFoil === "Al") {
                anodeFoil = 0.0106
            } else if (anodeFoil === "Cu") {
                anodeFoil = 0.0175
            }
            if (cathodeFoil === "Al") {
                cathodeFoil = 0.0106
            } else if (cathodeFoil === "Cu") {
                cathodeFoil = 0.0175
            }
            var active = mass - anodeFoil - cathodeFoil
            active = Math.round(active * 1000) / 1000
            var result = ampPerGram * active * 1000
            result = Math.round(result * 100) / 100
            document.getElementById("result").innerHTML = result;        
            if (result <= 0) {
                document.getElementById("result").innerHTML = "..."
            }
        }
        function cc() {
            var el = document.createElement('textarea');
            el.value = (document.getElementById("result").innerHTML)
            el.setAttribute('readonly', '');
            el.style = { position: 'absolute', left: '-9999px' };
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
        }
        function csv() {
            var testCode = document.getElementById("testCode").value;
            var cathode = document.getElementById("cathode").value;
            var anode = document.getElementById("anode").value;
            var anodeSol = document.getElementById("anodeSol").value;
            var anodeThick = document.getElementById("anodeThick").value;
            var anodeFoil = document.getElementById("anodeFoil").value;
            var necLayer = document.getElementById("necLayer").value;
            var necWatt = document.getElementById("necWatt").value;
            var necMinute = document.getElementById("necMinute").value;
            var protectLayer = document.getElementById("protectLayer").value;
            var protectWatt = document.getElementById("protectWatt").value;
            var protectTime = document.getElementById("protectTime").value;
            var mass = document.getElementById("mass").value;
            var c1 = document.getElementById("1").value;
            var c2 = document.getElementById("2").value;
            var c3 = document.getElementById("3").value;
            var c4 = document.getElementById("4").value;
            var c5 = document.getElementById("5").value;
            var c6 = document.getElementById("6").value;
            var c7 = document.getElementById("7").value;
            var c8 = document.getElementById("8").value;
            var c9 = document.getElementById("9").value;
            var c10 = document.getElementById("10").value;
            var c15 = document.getElementById("15").value;
            var c20 = document.getElementById("20").value;
            var c30 = document.getElementById("30").value;
            var c50 = document.getElementById("50").value;
            var c100 = document.getElementById("100").value;
            const value = ["", testCode, cathode, anode, anodeSol, anodeThick, anodeFoil, necLayer,necWatt, necMinute, protectLayer, protectWatt, protectTime, mass, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c15, c20, c30, c50, c100]
            let finalValue = value.toString()
            download("file.csv", finalValue);
        }
        function download(filename, text) {
            var element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
            element.setAttribute('download', filename);
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }
    </script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
</head>
<body style="background-color: #e0e0e0;overflow: auto;padding: 2vw;font-family: 'Courier New', Courier, monospace;">
    <div style="display: grid;place-items: center;height: 100vh;">
        <div class="box content">
            <h1>General Data</h1> 
            <div class="columns" style="display: flex;">
                <label class="column"> Test-Code
                    <input class="input" id="testCode">
                </label>
                <label class="column"> Cathode
                    <input class="input" id="cathode">
                </label>
                <label class="column"> Anode
                    <input class="input" id="anode">
                </label>
                <label class="column"> Anode Solution
                    <input class="input" id="anodeSol">
                </label>
                <label class="column"> Anode Thickness (Î¼)
                    <input class="input" id="anodeThick">
                </label>
                <label class="column"> Anode Foil
                    <input class="input" id="anodeFoil">
                </label>
            </div>
            <h2>NEC</h2> 
            <div class="columns" style="display: flex;">
                <label class="column"> NEC Layer 
                    <input class="input" id="necLayer">
                </label>
                <label class="column"> NEC (Watt) 
                    <input class="input" id="necWatt">
                </label>
                <label class="column"> NEC (Minute) 
                    <input class="input" id="necMinute">
                </label>
                <label class="column"> Protect Layer 
                    <input class="input" id="protectLayer">
                </label>
                <label class="column"> Protect (Watt)
                    <input class="input" id="protectWatt">
                </label>
                <label class="column"> Protect (Time) 
                    <input class="input" id="protectTime">
                </label>
            </div>
        </div>
        <div class="columns">
            <div class="column box content" style="margin: .75rem .75rem 2vw .75rem; max-width: 20vw;text-align: center;">
                <h1>mA Cal.</h1>
                <label> Electrode Mass <br>
                    <input id="mass" class="input" style="max-width: 80%;text-align: center;" type="number" onChange="calculate()">
                </label>
                <br>
                <br>
                <div>
                    <label> Anode Foil <br>
                        <div class="select">
                            <select id="anodeFoil" onChange="calculate()">
                                <option value="Cu">Cu</option>
                                <option value="Al">Al</option>
                            </select>
                        </div>
                    </label>
                    </div>
                <br>
                <div>
                    <label> Cathode Foil <br>
                        <div class="select">
                            <select id="cathodeFoil" onChange="calculate()">
                                <option value="Al">Al</option>
                                <option value="Cu">Cu</option>
                            </select>
                        </div>
                    </label>
                </div>
                <br>
                <label> A/g <br>
                    <input  id="ampPerGram" class="input" style="max-width: 80%;text-align: center;" value="0.025" onChange="calculate()">
                </label>
                <br>
                <br>
                <label> Current (mA) <br><br>
                    <div id="result" style="text-align: center;" onChange="calculate()">
                        ...
                    </div>
                </label>
                <br>
                <button class="button" id="copy" onclick="cc()">Copy</button> 
            </div>
            <div class="box content column" style="margin: .75rem .75rem 2vw .75rem;">
                <h1>Cycles</h1> 
                <div>
                    <div>
                        <div class="columns">
                            <div class="column" style="text-align: center;">
                                Cycle
                                <br>
                                <br>
                                <p>1</p>
                                <br>
                                <p>2</p>
                                <br>
                                <p>3</p>
                                <br>
                                <p>4</p>
                                <br>
                                <p>5</p>
                            </div>
                            <div class="column">
                                Energy discharge (mWh)
                                <input class="input" type="number" id="1">
                                <br>
                                <br>
                                <input class="input" type="number" id="2">
                                <br>
                                <br>
                                <input class="input" type="number" id="3">
                                <br>
                                <br>
                                <input class="input" type="number" id="4">
                                <br>
                                <br>
                                <input class="input" type="number" id="5">
                            </div>
                            <div class="column" style="text-align: center;">
                                Cycle
                                <br>
                                <br>
                                <p>6</p>
                                <br>
                                <p>7</p>
                                <br>
                                <p>8</p>
                                <br>
                                <p>9</p>
                                <br>
                                <p>10</p>
                            </div>
                            <div class="column">
                                Energy discharge (mWh)
                                <input class="input" type="number" id="6">
                                <br>
                                <br>
                                <input class="input" type="number" id="7">
                                <br>
                                <br>
                                <input class="input" type="number" id="8">
                                <br>
                                <br>
                                <input class="input" type="number" id="9">
                                <br>
                                <br>
                                <input class="input" type="number" id="10">
                            </div>
                            <div class="column" style="text-align: center;">
                                Cycle
                                <br>
                                <br>
                                <p>15</p>
                                <br>
                                <p>20</p>
                                <br>
                                <p>30</p>
                                <br>
                                <p>50</p>
                                <br>
                                <p>100</p>
                            </div>
                            <div class="column">
                                Energy discharge (mWh)
                                <input class="input" type="number" id="15">
                                <br>
                                <br>
                                <input class="input" type="number" id="20">
                                <br>
                                <br>
                                <input class="input" type="number" id="30">
                                <br>
                                <br>
                                <input class="input" type="number" id="50">
                                <br>
                                <br>
                                <input class="input" type="number" id="100">
                            </div>
                        </div>
                    </div>
                    <div style="display: grid;place-content: center;">
                        <br>
                        <br>
                        <button class="button" onclick="csv()">Download CSV</button>    
                        <br>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>